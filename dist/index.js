!function(e){var t={};function r(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)r.d(n,o,function(t){return e[t]}.bind(null,o));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=0)}([function(e,t){var r=window.Vue;window.$,new r({el:"#app",data:{username:"",password:"",code:"",message:"Sign in to start your session",error:!1},created:function(){var e,t,r=this;return regeneratorRuntime.async(function(n){for(;;)switch(n.prev=n.next){case 0:"credentials"in navigator&&(localStorage.getItem("app.fido2")?(e=localStorage.getItem("app.fido2"),t=(t=this.$gql.query("api",{credentialRequestOptions:{__args:{username:e}}})).data,(new WebAuthn).authenticate(t.data.data.credentialRequestOptions).then(function(t){r.$gql.query("api",{loginWebAuthn:{__args:{username:e,assertion:JSON.stringify(t)}}}).then(function(e){e.data.data.loginWebAuthn?window.self.location.reload():bootbox.alert("login error")})}).catch(function(e){r.passwordLogin()})):this.passwordLogin());case 1:case"end":return n.stop()}},null,this)},mounted:function(){localStorage.getItem("app.username")&&(this.username=localStorage.getItem("app.username"),this.$refs.remember.checked=!0)},methods:{passwordLogin:function(){var e=this;navigator.credentials.get({password:!0}).then(function(t){t&&e.login(t.id,t.password)})},login:function(e,t,r){var n,o,a=this;return regeneratorRuntime.async(function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,regeneratorRuntime.awrap(this.$gql.mutation("api",{login:{__args:{username:e,password:t,code:r||""},username:!0}}));case 2:if(!(n=(n=s.sent).data).error){s.next=8;break}return this.error=!0,"2-step verification"==n.error.message?bootbox.prompt("Please input 2-step verification code",function(r){r&&a.login(e,t.code)}):this.message=n.error.message,s.abrupt("return");case 8:n.data.login&&(this.$refs.remember.checked?localStorage.setItem("app.username",e):localStorage.removeItem("app.username"),""!=(o=window.self.location.hash)?window.self.location=o.substring(1):window.self.location.reload());case 9:case"end":return s.stop()}},null,this)},signIn:function(){return""==this.username?(this.error=!0,void(this.message="Please input username")):""==this.password?(this.error=!0,void(this.message="Please input password")):this.login(this.username,this.password)},forgetPassword:function(){var e=this,t=bootbox.dialog({title:"Forget password",message:document.getElementById("forget-dialog").innerHTML,centerVertical:!0,buttons:{submit:{label:"Submit",className:"btn-success",callback:function(){var r,n;return regeneratorRuntime.async(function(o){for(;;)switch(o.prev=o.next){case 0:if((r=t.find("form")[0]).checkValidity()){o.next=3;break}return o.abrupt("return");case 3:return o.next=5,regeneratorRuntime.awrap(e.$gql.mutation("api",{forgotPassword:{__args:{username:r.username.value,email:r.email.value}}}));case 5:(n=(n=o.sent).data).error?bootbox.alert(n.error.message):bootbox.alert("Password sent to your email if information correct");case 8:case"end":return o.stop()}})}}}})}}})}]);