!function(e){var t={};function r(o){if(t[o])return t[o].exports;var n=t[o]={i:o,l:!1,exports:{}};return e[o].call(n.exports,n,n.exports,r),n.l=!0,n.exports}r.m=e,r.c=t,r.d=function(e,t,o){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(r.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)r.d(o,n,function(t){return e[t]}.bind(null,n));return o},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=0)}([function(e,t){var r=window.Vue;r.use(VueLocalStorage);var o=window.$;new r({el:"#app",data:{username:"",password:"",code:"",message:"Sign in to start your session",error:!1},created:function(){var e=this;if("credentials"in navigator)if(localStorage.getItem("app.fido2")){var t=localStorage.getItem("app.fido2");this.$gql.query("api",{credentialRequestOptions:{__args:{username:t}}}).then(function(r){(new WebAuthn).authenticate(r.data.data.credentialRequestOptions).then(function(r){e.$gql.query("api",{loginWebAuthn:{__args:{username:t,assertion:JSON.stringify(r)}}}).then(function(e){e.data.data.loginWebAuthn?window.self.location.reload():bootbox.alert("login error")})}).catch(function(t){e.passwordLogin()})})}else this.passwordLogin()},mounted:function(){var e=this;o(this.$refs.rememberMe).iCheck({checkboxClass:"icheckbox_square-blue",radioClass:"iradio_square-blue",increaseArea:"20%"}),o(this.$refs.rememberMe).on("ifChecked",function(){e.$localStorage.set("app.remember_me",!0)}),o(this.$refs.rememberMe).on("ifUnchecked",function(){e.$localStorage.set("app.remember_me",!1)}),"true"==this.$localStorage.get("app.remember_me")&&(this.username=this.$localStorage.get("app.username"),o(this.$refs.rememberMe).iCheck("check"),o(this.$refs.rememberMe).iCheck("update"))},methods:{passwordLogin:function(){var e=this;navigator.credentials.get({password:!0}).then(function(t){t&&e.login(t.id,t.password)})},login:function(e,t,r){var o=this;this.$gql.mutation("api",{login:{__args:{username:e,password:t,code:r||""},username:!0}}).then(function(r){var n=r.data;if(n.data.login){"true"==o.$localStorage.get("app.remember_me")&&o.$localStorage.set("app.username",e);var a=o.$refs.redirect.value;""!=a?window.self.location=a:window.self.location.reload()}else"2-step verification"==n.error.message?bootbox.prompt("Please input 2-step verification code",function(r){r&&o.login(e,t,r)}):(o.message=n.error.message,o.error=!0)})},signIn:function(){return""==this.username?(this.error=!0,void(this.message="Please input username")):""==this.password?(this.error=!0,void(this.message="Please input password")):void this.login(this.username,this.password)},forgetPassword:function(){var e=this,t=bootbox.dialog({title:"Forget password",message:o("#forget_dialog").html()}).on("shown.bs.modal",function(){o(this).find("form").on("submit",function(){var r=o(this).getFormData();return e.$gql.query("api",{forgotPassword:{__args:r}}).then(function(e){var r=e.data;t.modal("hide"),r.error?bootbox.alert(r.error.message):bootbox.alert("Password sent to your email if information correct")}),!1})})}}})}]);